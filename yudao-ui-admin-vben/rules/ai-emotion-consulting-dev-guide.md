---
description: 
globs: 
alwaysApply: false
---
# AI 情感咨询项目开发文档

## 一、项目简介

本项目基于 dify 的 AI 对话能力，打造一个面向用户的情感咨询平台。用户可通过网页与 AI 进行情感交流、倾诉和咨询，获得智能化的情感支持和建议。参考项目为 [白小猫AI情感咨询](mdc:https:/www.whitexiaomao.com/#/chat/freeChat)。

-- 参考页面：https://www.whitexiaomao.com/#/chat/freeChat
---

## 二、功能点梳理

### 1. 前端功能点

- 用户登录/注册（可选，支持匿名模式）
- 聊天界面（消息输入、消息展示、滚动、时间戳、头像等）
- AI 回复实时流式展示（打字机效果）
- 聊天历史记录查看与管理
- 情感标签/话题选择（如：失恋、压力、家庭、职场等）
- 反馈与评价（对 AI 回复进行点赞/点踩/反馈）
- 隐私保护提示与协议
- 多端适配（PC、移动端响应式设计）
- 主题切换（明暗模式）
- 加载动画与错误提示
- 用户引导（新手引导、常见问题）

### 2. 后端功能点

- 用户管理（注册、登录、匿名会话、用户信息存储）
- 聊天会话管理（会话ID、历史消息存储、分页查询）
- AI 对话接口对接（与 dify API 对接，支持流式回复）
- 情感标签/话题管理
- 日志与监控（请求日志、异常日志、接口调用监控）
- 反馈收集与分析
- 数据安全与隐私保护（加密存储、脱敏处理）
- 限流与防刷（防止恶意请求）
- 管理后台（用户、会话、反馈、标签等管理）

---

## 三、前端开发注意事项

1. **UI/UX 设计**
   - 聊天窗口需简洁温馨，降低用户心理负担。
   - 输入框支持多行输入，发送快捷键（Enter/Shift+Enter）。
   - AI 回复需有流式打字效果，提升真实感。
   - 明确展示隐私保护与免责声明。

2. **状态管理**
   - 使用如 Redux、Pinia、Vuex 等进行全局状态管理。
   - 聊天消息、用户信息、会话状态需统一管理。

3. **API 对接**
   - 与后端接口解耦，封装 API 请求模块。
   - 处理流式响应（如 EventSource、WebSocket、Fetch 的 ReadableStream）。

4. **异常处理**
   - 网络异常、AI 无法回复、接口超时等需友好提示。
   - 重要操作需二次确认（如清空历史）。

5. **安全性**
   - 防止 XSS、CSRF 等前端常见安全问题。
   - 用户数据本地存储需加密（如 localStorage、IndexedDB）。

6. **适配性**
   - 响应式布局，适配不同终端。
   - 兼容主流浏览器。

---

## 四、后端开发注意事项

1. **接口设计**
   - RESTful 或 GraphQL 风格，接口文档清晰。
   - 支持流式消息推送（SSE、WebSocket）。

2. **AI 对接**
   - dify API 封装，支持多模型、多参数配置。
   - 失败重试、超时处理、异常兜底回复。

3. **数据存储**
   - 聊天记录、用户信息、反馈等需持久化存储（如 MySQL、MongoDB）。
   - 敏感信息加密存储，符合隐私合规要求。

4. **安全与隐私**
   - 用户身份校验（JWT、Session、Token）。
   - 数据脱敏、日志不记录敏感内容。
   - 合理设置接口限流，防止刷接口。

5. **扩展性**
   - 预留多 AI 模型接入能力。
   - 支持多语言、多主题扩展。

6. **监控与运维**
   - 日志采集、接口监控、异常报警。
   - 重要操作有审计日志。

---

## 五、开发流程建议

1. **需求梳理与原型设计**
   - 明确核心功能，绘制界面原型。
2. **前后端接口定义**
   - 约定接口格式、数据结构、错误码。
3. **后端开发**
   - 用户、会话、AI 对接、数据存储等模块。
4. **前端开发**
   - 聊天界面、消息流、API 对接、UI 细节。
5. **联调与测试**
   - 功能测试、异常测试、压力测试。
6. **上线与运维**
   - 部署、监控、用户反馈收集。

---

## 六、参考项目分析

- [白小猫AI情感咨询](mdc:https:/www.whitexiaomao.com/#/chat/freeChat) 采用了简洁的聊天界面，支持匿名、流式回复、情感标签选择等功能，用户体验良好。
- 可借鉴其 UI 风格、流式消息体验、隐私保护提示等设计。

---

## 七、总结

本项目以 dify AI 对话为核心，结合情感咨询场景，需重点关注用户体验、数据隐私与安全、AI 回复的温度与准确性。前后端需协同开发，接口清晰，功能可扩展，保障系统稳定与用户数据安全。

